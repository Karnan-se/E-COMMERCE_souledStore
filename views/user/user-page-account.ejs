<!DOCTYPE html>
<html class="no-js" lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/page-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Jul 2023 10:11:15 GMT -->

<head>
    <meta charset="utf-8">
    <title>Evara - eCommerce HTML Template</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link rel="stylesheet" href="/assets/css/maind134.css?v=3.4">
    
    <script src="https://unpkg.com/easyinvoice/dist/easyinvoice.min.js"></script>
    
    
</head>

<body>

    <%- include("./partials/header")%>
        </div>
        </div>
        </div>
        <% if(typeof message !=="undefined" ){%>
            <script>
                Swal.fire({
                    icon: "warning",
                    title: "password Updated"
                })

            </script>


            <% }%>

                <main class="main">
                    <div class="page-header breadcrumb-wrap">
                        <div class="container">
                            <div class="breadcrumb">
                                <a href="index.html" rel="nofollow">Home</a>
                                <span></span> Pages
                                <span></span> Account
                            </div>
                        </div>
                    </div>
                    <section class="pt-150 pb-150">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-10 m-auto">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="dashboard-menu">
                                                <ul class="nav flex-column" role="tablist">
                                                    <li class="nav-item">
                                                        <a class="nav-link active" id="dashboard-tab"
                                                            data-bs-toggle="tab" href="#dashboard" role="tab"
                                                            aria-controls="dashboard" aria-selected="false"><i
                                                                class="fi-rs-settings-sliders mr-10"></i>Dashboard</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a class="nav-link" id="orders-tab" data-bs-toggle="tab"
                                                            href="#orders" role="tab" aria-controls="orders"
                                                            aria-selected="false"><i
                                                                class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                                    </li>

                                                    <li class="nav-item">
                                                        <a class="nav-link" id="Wallet-tab-link" data-bs-toggle="tab" href="#Wallet-tab" role="tab" aria-controls="Wallet" aria-selected="false">
                                                            <i class="fi-rs-shopping-bag mr-10"></i>Wallet
                                                        </a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a class="nav-link" id="track-orders-tab" data-bs-toggle="tab"
                                                            href="#track-orders" role="tab" aria-controls="track-orders"
                                                            aria-selected="false"><i
                                                                class="fi-rs-shopping-cart-check mr-10"></i>Track Your
                                                            Order</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a class="nav-link" id="address-tab" data-bs-toggle="tab"
                                                            href="#address" role="tab" aria-controls="address"
                                                            aria-selected="true"><i class="fi-rs-marker mr-10"></i>My
                                                            Address</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a class="nav-link" id="account-detail-tab" data-bs-toggle="tab"
                                                            href="#account-detail" role="tab"
                                                            aria-controls="account-detail" aria-selected="true"><i
                                                                class="fi-rs-user mr-10"></i>Account details</a>
                                                    </li>
                                                    <li class="nav-item">
                                                        <a class="nav-link" href="page-login-register.html"><i
                                                                class="fi-rs-sign-out mr-10"></i>Logout</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="col-md-8">
                                            <div class="tab-content dashboard-content">
                                                <div class="tab-pane fade active show" id="dashboard" role="tabpanel"
                                                    aria-labelledby="dashboard-tab">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h5 class="mb-0">Hello Rosie! </h5>
                                                        </div>
                                                        <div class="card-body">
                                                            <p>From your account dashboard. you can easily check &amp;
                                                                view your <a href="#">recent orders</a>, manage your <a
                                                                    href="#">shipping and billing addresses</a> and <a
                                                                    href="#">edit your password and account details.</a>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="orders" role="tabpanel"
                                                    aria-labelledby="orders-tab">
                                                    <!-- <script>
                                                        async function getInvoice(orderId){
                                                            try {
                                                                const response = await fetch(`/getInvoice?orderId=${orderId}`,{
                                                                    method:"GET",
                                                                })
                                                                if(!response){
                                                                    throw new Error("Internal server Error")
                                                                }
                                                                console.log(data.filePath)
                                                               
                                                                const downloadUrl = `../../invoice/${data.filePath}`;
                                                                const link = document.createElement('a');
                                                                link.href = downloadUrl;

                                                               
                                                               
                                                                
                                                            } catch (error) {
                                                                
                                                            }
                                                        }

                                                        </script> -->

                                                <%order.reverse() %>
                                              

                                                    <% order.forEach((items) => { %> 
                                                    <div class="card">
                                                        <div class="card-header order d-flex justify-content-between">
                                                            <div>
                                                                <h5 class="mb-0">Your Orders</h5>
                                                            </div>
                                                            
                                                            <div>
                                                                <a  href= "/getInvoice?orderId=<%= items._id %>" class="mb-0 invoice <%=items.orderStatus == "delivered"? "" : "d-none"%>"  >#invoice</a>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                    <% items.products.forEach((item) => { %>
                                                                       
                                                                        
                                                                        <div class="product-info position-relative">
                                                                            <div class="row">
                                                                                <div class="col-md-2">
                                                                                    <div class="d-flex h-100">
                                                                                        <div class="object-fit img-fluid h-100">
                                                                                            <img src="/temp/<%= item.product.images[0] %>" alt="Product Image">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="col-md-4">
                                                                                    <div class="d-flex flex-column">
                                                                                        <div class="product-details">
                                                                                            <div class="product-name"> <%= item.product.productname %></div>
                                                                                            <div class="product-size">Size: <%= item.size %></div>
                                                                                            <div class="product-quantity">Quantity: <%= item.quantity %></div>

                                                                                            <% if (items.orderStatus !=="delivered" || item.isOrderCancelled == true ) {%>
                                                                                            <%if(item.isOrderCancelled == false) {%>
                                                                                            <div class="exchange-details <%= items.orderStatus == "Pending"? "text-warning" : "text-success"%>">OrderStatus: <%= items.orderStatus %></div> 
                                                                                            <% } else if(item.isOrderCancelled == true) { %>
                                                                                                <div class="exchange-details text-danger">OrderStatus: Cancelled</div> 
                                                                                                <% }%>

                                                                                                <% }else if(items?.orderStatus == "delivered" || item.isOrderReturned == true ) {%>
                                                                                                <%if(item.isOrderReturned == false) {%>
                                                                                                    <div class="exchange-details <%= items.orderStatus == "Pending"? "text-warning" : "text-success"%>">OrderStatus: <%= items.orderStatus %></div> 
                                                                                                    <% }else if(item.isOrderReturned == true) {%>
                                                                                                        <div class="exchange-details text-danger">OrderStatus: Returned</div> 
                                                                                                        <% }%>

                                                                                                        <% }%>
                                                                                                         <div class="">

                                                                                                            <span class="<%= (item.orginalPrice > 0) ? 'old-price' : 'd-none' %>">
                                                                                                                <%= item.orginalPrice ?? '' %>
                                                                                                            </span>

                                                                                                            <div class="d-flex align-items-center">
                                                                                                                <% if (item.discountrecieved > 0) { %>
                                                                                                                    <span class="">Price</span>
                                                                                                                    <span class="old-price me-2 mx-2">&#x20b9; <%= item.price + item.discountrecieved %></span>
                                                                                                                <% } %>
                                                                                                                <div> &#x20b9; <%= item.price %></div>
                                                                                                            </div>
                                                                                                           

                                                                                        <div class="text-brand <%= item.discountrecieved <= 0 ? 'd-none' : '' %>">
                                                                                            Discount received &#x20b9; <%= item.discountrecieved %>
                                                                                        </div>
                                                                                    </div>

                                                                                        </div>
                                                                                    </div>
                                                                                    <style>
                                                                                        .old-price {
                                                                                            text-decoration: line-through;
                                                                                            color: grey;
                                                                                        }
                                                                                    </style>
     
                                                                                </div>
                                                                                <div class="col-md-4">
                                                                                   
                                                                                    <div class="d-flex align-items-center flex-column">
                                                                                        <span class="fw-large">ADDRESS</span>
                                                                                        <div class="d-flex flex-column p-2 text-md-end">
                                                                                            
                                                                                          <span class="fw-medium">
                                                                                            <%= items.addresstoDeliver.houseaddress %><br>
                                                                                            <%= items.addresstoDeliver.city %>, <%= items.addresstoDeliver.district %><br>
                                                                                            <%= items.addresstoDeliver.state %><br>
                                                                                            <%= items.addresstoDeliver.phonenumber %>
                                                                                          </span>
                                                                                        </div>
                                                                                      </div>
                                                                                </div>
                                                                                <div class="col-md-2">
                                                                                    <% if (items?.paymentStatus === "PaymentRecieved" &&  item.isOrderCancelled == false && item.isOrderReturned == false) { %>
                                                                                        <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                            <img src="/assets/orderimages/paid.jpeg" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Paid Image">
                                                                                        </div>
                                                                                    <% } else if (items?.paymentStatus === "pending") { %>
                                                                                        <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                            <img src="/assets/orderimages/pending.jpeg" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Pending Image">
                                                                                        </div>
                                                                                    <% } else if (items?.paymentStatus === "PaymentFailed") { %>
                                                                                        <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                            <img src="/assets/orderimages/failed.jpeg" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Failed Image">
                                                                                        </div>
                                                                                        <%} else if(items?.orderStatus == "Cancelled" ) {%>
                                                                                            <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                                <img src="/assets/orderimages/cancelled.jpeg" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Failed Image">
                                                                                            </div>
                                                                                            <%} else if(item.isOrderCancelled == true) {%>
                                                                                                <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                                    <img src="/assets/orderimages/cancelled.jpeg" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Failed Image">
                                                                                                </div>
                                                                                                <%}else if (item.isOrderReturned == true) {%>
                                                                                                    <div class="d-flex position-relative" style="width: 60px; height: 60px;">
                                                                                                        <img src="/assets/orderimages/returned.webp" class="img-fluid position-absolute top-0 start-0 end-0 bottom-0 m-auto" style="object-fit: contain; width: 100%; height: 100%;" alt="Failed Image">
                                                                                                    </div>
                                                                                                    <%}%>
                                                                                                    </div>

                                                                                                </div>
                                                                                            </div>
                                                                                            <br>
                                                                       
                                                                            <div class="action-buttons">
<!------------------------------------------------------------------------------------------------------------------------------------------------------- cancel Button -->
                                                                                <% if(items.paymentStatus == "PaymentFailed" || items.paymentStatus == "Pending") {%>
                                                                                    <button type="button"  class=" btn btn-danger d-none" >Retry-transaction</button>
                                                                                        <% } else if(item.isOrderCancelled == true || item.isOrderReturned == true ){%>

                                                                                            <button type="button" class="d-none"></button>

                                                                                        <% } else {%>
                                                                                <button class="return-exchange-button btn cancelButton <%=items.orderStatus == "delivered"? "btn-bb-dark" : "text-white" %>" data-orderId =<%= items._id%> data-productId = <%= item._id%> data-price = <%= item.price%>>  <%= items.orderStatus == "delivered" ? "Return":"Cancel" %>
                                                                                    <% }%>

                                                                                </button>
                                                                               
                                                                                
                                                                            </div>

                                                                            <div class="rating-feedback d-flex justify-content-between align-items-center">
                                                                                <div class="rating-stars">
                                                                                    <div class="rating-box">
                                                                                    
                                                                                        <div class="stars">
                                                                                            <% if(items.orderStatus == "delivered") {%>

                                                                                              <a href="/ratings?orderid=<%=items._id%>&productId=<%=item.product._id %>&itemSize=<%= item.size %>"> <p class="text-black ratingButon"  >Rate This Product</p></a>
                                                                                    

                                                                                            <%}%>
                                                                                        </div>
                                                                                      </div>
                                                                                </div>
                                                                                

                                                                                

                                                                            </div>
                                                                                                
                                                                                                <hr>
                                                                                            <% }) %>
                                                                    
                                                                    
                                                                    <hr>
                                                                    <div>
                                                                        <% if(items.orderStatus == "delivered" || items.orderStatus == "Cancelled" || items.orderStatus== "Returned") {%>
                                                                            <button class="track-button btn d-none btn-warning" data-bs-target="#orderDetailsModal"  data-bs-toggle="modal">Track</button>
                                                                            <% }else if(items.paymentStatus == "PaymentFailed" || items.paymentStatus == "Pending"){%>

                                                                                <button type="button"  class=" btn btn-danger retryTransaction "  data-amount="<%=items.totalAmount%>" data-orderId="<%=items._id%>">Retry-transaction</button>

                                                                                
                                                                            <%} else {%>'
                                                                            <button class="track-button btn btn-warning " data-bs-target="#orderDetailsModal"  data-bs-toggle="modal">Track</button>
                                                                            <%}%>
                                                                        </div>

                                                                    <div class="total d-flex  justify-content-end" style="font-size: 24px; font-weight: bold; width: 100%;">
                                                                        Total Price: &#x20b9;  <%= items.totalAmount %>
                                                                    </div>

                                                                   





                                                                    <style>
                                                                        .rating-box{
                                                                            cursor: pointer;
                                                                            outline: none;
                                                                            text-decoration: none;
                                                                        }
                                                                        
                                                                        .stars i {
                                                                        color: #ffffff;
                                                                        font-size: 15px;
                                                                        cursor: pointer;
                                                                        transition: color 0.2s ease;
                                                                            
                                                                       
                                                                        }
                                                                        .stars i.active {
                                                                        color: #ff9c1a;
                                                                        }
                                                                        .stars i:focus {
                                                                        outline: none;
                                                                        }
                                                            </style>
                                                          
                                                           
     
                                                            </div>
                                                        </div>
                                                        





                                                    </div>




                                                     <style>
                                                         .table-responsive {
                                                         overflow-x: hidden;
                                                         overflow-y: hidden;
                                                         
                                                    }
                                                    .card-header{
                                                        background-color: bisque;
                                                    }

                                                     .card {
                                                         background-color: #f8f9fa;
                                                         color: rgb(34, 34, 59);
                                                         border-bottom: 2px solid  black;
                                                         border-right: 2px solid black;
                                                         border-left: 2px solid black;
                                                         border-top: 2px solid black;
                                                         border-radius: 5px;
                                                         box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.3);

                                                         
                                                        
                                                     }
                                                     .order{
                                                         background-color: #488978;
                                                     }
                                                      </style>


                                                    <div class="mt-3 mb-3 bg-dark ">
                                                        <div class="bg-dark"></div>
                                                        <!-- Content goes here -->
                                                    </div>
                                                    <template id="my-template">
                                                        <swal-title>
                                                          Save changes to "" before closing?
                                                        </swal-title>
                                                        <swal-icon type="warning" color="red"></swal-icon>
                                                        <swal-button type="confirm">
                                                          Confirm
                                                        </swal-button>
                                                        <swal-button type="cancel">
                                                          Cancel
                                                        </swal-button>
                                                        <swal-param name="allowEscapeKey" value="false" />
                                                        <swal-param
                                                          name="customClass"
                                                          value='{ "popup": "my-popup" }' />
                                                        <swal-function-param
                                                          name="didOpen"
                                                          value="popup => console.log(popup)" />
                                                      </template>
                                                      <style>
                                                        .center-icon {
                                                            display: flex;
                                                            justify-content: center;
                                                            align-items: center;
                                                        }
                                                        </style>
                                                      
                                                      
                                                    
                                                    <% }) %>

                                                    <div class="pagination-area mt-15 mb-50">
                                                        <nav aria-label="Page navigation example">
                                                            <ul class="pagination">
                                                            
                                                                <% for (let i = 1; i <= totalPages; i++) { %>
                                                                   
                                                                        <a class="page-link" href="/myAccount?orderpage=<%= i %>"><%= i %></a>
                                                                    </li>
                                                                <% } %>
                                                            </ul>
                                                            
                                                        </nav>
                                                    </div>







                                                    <script>
                                                        const retryButton = document.querySelectorAll(".retryTransaction");
                                                        retryButton.forEach((retry)=>{
                                                            retry.addEventListener("click", async function(){
                                                                console.log("retyTransaction");
                                                                const totalamount = this.getAttribute("data-amount")
                                                                const productorderId = this.getAttribute("data-orderId")
                                                                console.log(totalamount)
                                                                const response = await fetch(`/retryTransaction?totalPrice=${totalamount}`,{
                                                                    method:"GET",
                                                                })
                                                                if(!response){
                                                                    throw new Error("internal Server Error")
                                                                }
                                                                const data = await response.json();
                                                                var options = {
                                                                                                                "key": "rzp_test_ihsNz6lracNIu3", 
                                                                                                                "amount": data.order.amount, 
                                                                                                                "currency": "INR",
                                                                                                                "name": "Karnan Corp",
                                                                                                                "description": "Test Transaction",
                                                                                                                "image": "https://example.com/your_logo",
                                                                                                                "order_id": data.order.order_id, 
                                                                                                                "handler": async (responseHandler) => {
                                                                                                                    const responseStatus = await fetch(`/paymentStatus?status=${"PaymentRecieved"}&orderId=${productorderId}`,{
                                                                                                                        method:"GET"

                                                                                                                    })
                                                                                                                    if(!responseStatus){
                                                                                                                        throw new Error("Internal Server Error")
                                                                                                                    }
                                                                                                                    const datas= responseStatus.json()
                                                                                                                    console.log(datas.datas)
                                                                                                                    const Toast = Swal.mixin({
                                                                                                                    toast: true,
                                                                                                                    position: "top-end",
                                                                                                                    showConfirmButton: false,
                                                                                                                    timer: 3000,
                                                                                                                    timerProgressBar: true,
                                                                                                                    didOpen: (toast) => {
                                                                                                                        toast.onmouseenter = Swal.stopTimer;
                                                                                                                        toast.onmouseleave = Swal.resumeTimer;
                                                                                                                    }
                                                                                                                    });
                                                                                                                    Toast.fire({
                                                                                                                    icon: "success",
                                                                                                                    title: "Order placed Successfully"
                                                                                                                    }).then(()=>window.location.reload())
                                                                                                                    
                                                                                                                   
                                                                                                                },
                                                                                                                "theme": {
                                                                                                                    "color": "#3399cc"
                                                                                                                }
                                                                                                            };
                                                                                                            var rzp1 = new Razorpay(options);
                                                                                                            rzp1.on('payment.failed', async (responseFailed) => {
                                                                                                                const responseStatus = await fetch(`/paymentStatus?status=${'PaymentFailed'}&orderId=${productorderId}`, {
                                                                                                                    method: "GET",
                                                                                                                });
                                                                                                                if (!responseStatus) {
                                                                                                                    throw new Error("Internal server Error");
                                                                                                                }
                                                                                                                const paymentFailed = await responseStatus.json();
                                                                                                                console.log(paymentFailed);

                                                                                                                const Toast = Swal.mixin({
                                                                                                                    toast: true,
                                                                                                                    position: "top-end",
                                                                                                                    showConfirmButton: false,
                                                                                                                    timer: 3000,
                                                                                                                    timerProgressBar: true,
                                                                                                                    didOpen: (toast) => {
                                                                                                                        toast.onmouseenter = Swal.stopTimer;
                                                                                                                        toast.onmouseleave = Swal.resumeTimer;
                                                                                                                    }
                                                                                                                    });
                                                                                                                    Toast.fire({
                                                                                                                    icon: "warning",
                                                                                                                    title: "Transaction Failed"
                                                                                                                    }).then(()=>window.location.reload())
                                                                                                                
                                                                                                            });
                                                                                                            rzp1.open();
                                                                


                                                            })
                                                        })
                                                    </script>



                                                    <script>
                                                        const cancelButton = document.querySelectorAll(".cancelButton");
                                                        cancelButton.forEach((cancel)=>{
                                                            cancel.addEventListener("click",async function(){
                                                                const buttontext = cancel.textContent.trim()
                                                                
                                                               
                                                                Swal.fire({
                                                                    icon:"warning",
                                                                    title:`Are you sure want to ${buttontext}`,
                                                                    showCancelButton: true,
                                                                    confirmButtonText: "Yes",
                                                                    cancelButtonText: "Cancel",
                                                                    customClass: {
                                                                        icon: 'd-flex justify-content-center align-items-center center-icon'
                                                                    }
                                                                })
                                                                .then(async (result) =>{
                                                                    if(result.isConfirmed) {

                                                                if(cancel.textContent.trim() == "Cancel") {
                                                                    

                                                                const orderId = this.getAttribute("data-orderId")
                                                                const price = this.getAttribute("data-price");
                                                                const ProductId = this.getAttribute("data-productId");

                                                                const response = await fetch(`/cancelOrder?orderId=${orderId}&ProductId=${ProductId}&price=${price}`,{
                                                                    method:"GET",

                                                                })
                                                                if(!response){
                                                                    throw new Error("Internal Server Error")
                                                                }
                                                                const data  = await response.json();
                                                                console.log(data);
                                                              if(data.data == "paymentreturned"){
                                                                const Toast = Swal.mixin({
                                                                toast: true,
                                                                position: "top-end",
                                                                showConfirmButton: false,
                                                                timer: 3000,
                                                                timerProgressBar: true,
                                                                didOpen: (toast) => {
                                                                    toast.onmouseenter = Swal.stopTimer;
                                                                    toast.onmouseleave = Swal.resumeTimer;
                                                                }
                                                                });
                                                                Toast.fire({
                                                                icon: "success",
                                                                title: "Amont credited to The Wallet"
                                                                }).then(()=>window.location.reload())
                                                              }else{
                                                                const Toast = Swal.mixin({
                                                                toast: true,
                                                                position: "top-end",
                                                                showConfirmButton: false,
                                                                timer: 3000,
                                                                timerProgressBar: true,
                                                                didOpen: (toast) => {
                                                                    toast.onmouseenter = Swal.stopTimer;
                                                                    toast.onmouseleave = Swal.resumeTimer;
                                                                }
                                                                });
                                                                Toast.fire({
                                                                icon: "success",
                                                                title: "ORDER CANCELLED"

                                                                })
                                                                

                                                              }
                                                            }else if(cancel.textContent.trim() == "Return"){
                                                                const orderId = this.getAttribute("data-orderId")
                                                                const price = this.getAttribute("data-price");
                                                                const ProductId = this.getAttribute("data-productId");
                                                            const response = await fetch(`/returnOrder?orderId=${orderId}&ProductId=${ProductId}&price=${price}`,{
                                                                    method:"GET",

                                                                })
                                                                if(!response){
                                                                    throw new Error("Internal Server Error")
                                                                }
                                                                const data = await response.json()
                                                                if(data.data == "paymentreturned"){
                                                                const Toast = Swal.mixin({
                                                                toast: true,
                                                                position: "top-end",
                                                                showConfirmButton: false,
                                                                timer: 3000,
                                                                timerProgressBar: true,
                                                                didOpen: (toast) => {
                                                                    toast.onmouseenter = Swal.stopTimer;
                                                                    toast.onmouseleave = Swal.resumeTimer;
                                                                }
                                                                });
                                                                Toast.fire({
                                                                icon: "success",
                                                                title: "Amont credited to The Wallet"
                                                                }).then(()=>window.location.reload())
                                                              }else{
                                                                const Toast = Swal.mixin({
                                                                toast: true,
                                                                position: "top-end",
                                                                showConfirmButton: false,
                                                                timer: 3000,
                                                                timerProgressBar: true,
                                                                didOpen: (toast) => {
                                                                    toast.onmouseenter = Swal.stopTimer;
                                                                    toast.onmouseleave = Swal.resumeTimer;
                                                                }
                                                                });
                                                                Toast.fire({
                                                                icon: "success",
                                                                title: "ORDER RETURNED"

                                                                })
                                                                
                                                              }



                                                            }

                                                        }
                                                        })
                                                            })

                                                        })
                                                        </script>


                                                    <br>
                                                    <script>
                                                     const stars = document.querySelectorAll(".stars i");
                                                    stars.forEach((star, index) => {
                                                        star.addEventListener("click",async  function() {
                                                            const value = this.getAttribute("data-value");
                                                            const size = this.getAttribute("data-size")
                                                            const productId = this.getAttribute("data-product") 
                                                            const orderID =this.getAttribute("data-orderId")  
                                                            stars.forEach((s, i) => {
                                                                s.classList.remove("active");

                                                                if(i<= index) {
                                                                    s.classList.add("active")
                                                                }

                                                            });
                                                            console.log(`Ratings`,"size","productId",  value,size, productId)
                                                            const response = await fetch(`/addratings`,{
                                                                method:"POST",
                                                                headers:{
                                                                    
                                                                    "content-type": "application/json",
                                                            
                                                                },
                                                                body: JSON.stringify({
                                                                    value:value,
                                                                    size: size,
                                                                    productId: productId,
                                                                    orderID: orderID,
                                                                })
                                                                
                                                           
                                                            })
                                                            if(!response){
                                                                throw new Error("internal server Error")
                                                            }
                                                            const data= await response.json()
                                                            console.log(data);
                                                           
                                                            
                                                        });
                                                    });

                                                 </script>

                                                 <!-- track buttoon -->

                                                    <div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
                                                      <div class="modal-dialog modal-dialog-centered modal-xl">
                                                        <div class="modal-content">
                                                          <div class="modal-header">
                                                            <h5 class="modal-title" id="orderDetailsModalLabel">Order Details</h5>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                          </div>
                                                          <div class="modal-body">
                                                            <div class="col">
                                                              <div class="card card-stepper" style="border-radius: 10px;">
                                                                <div class="card-body p-4">
                                                    
                                                                  <div class="d-flex justify-content-between align-items-center">
                                                                    <div class="d-flex flex-column">
                                                                      <span class="lead fw-normal">Your order has been delivered</span>
                                                                      <span class="text-muted small">by DHFL on 21 Jan, 2020</span>
                                                                    </div>
                                                                  </div>
                                                                  <hr class="my-4">
                                                    
                                                                  <div class="d-flex flex-row justify-content-between align-items-center align-content-center">
                                                                    <span class="dot"></span>
                                                                    <hr class="flex-fill track-line"><span class="dot"></span>
                                                                    
                                                                    <hr class="flex-fill track-line"><span class="dot"></span>
                                                                    <hr class="flex-fill track-line"><span class="d-flex justify-content-center align-items-center big-dot dot">
                                                                      <i class="fa fa-check text-white"></i></span>
                                                                  </div>
                                                    
                                                                  <div class="d-flex flex-row justify-content-between align-items-center">
                                                                    <div class="d-flex flex-column align-items-start"><span>15 Mar</span><span>Order placed</span>
                                                                    </div>
                                                                  
                                                                    <div class="d-flex flex-column justify-content-center align-items-center"><span>15
                                                                        Mar</span><span>Order Dispatched</span></div>
                                                                    <div class="d-flex flex-column align-items-center"><span>15 Mar</span><span>Out for
                                                                        delivery</span></div>
                                                                    <div class="d-flex flex-column align-items-end"><span>15 Mar</span><span>Delivered</span></div>
                                                                  </div>
                                                    
                                                                </div>
                                                              </div>
                                                            </div>
                                                          </div>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    <style>
                                                        .track-line {
                                                                height: 2px !important;
                                                                background-color: #488978;
                                                                opacity: 1;
                                                                }

                                                                .dot {
                                                                height: 10px;
                                                                width: 10px;
                                                                margin-left: 3px;
                                                                margin-right: 3px;
                                                                margin-top: 0px;
                                                                background-color: #488978;
                                                                border-radius: 50%;
                                                                display: inline-block
                                                                }

                                                                .big-dot {
                                                                height: 25px;
                                                                width: 25px;
                                                                margin-left: 0px;
                                                                margin-right: 0px;
                                                                margin-top: 0px;
                                                                background-color: #488978;
                                                                border-radius: 50%;
                                                                display: inline-block;
                                                                }

                                                                .big-dot i {
                                                                font-size: 12px;
                                                                }

                                                                .card-stepper {
                                                                z-index: 0
                                                                }
                                                        </style>
                                                         










                                                </div>


                                                
                                                <div class="tab-pane fade" id="track-orders" role="tabpanel"
                                                    aria-labelledby="track-orders-tab">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h5 class="mb-0">Orders tracking</h5>
                                                        </div>
                                                        <div class="card-body contact-from-area">
                                                            <p>To track your order please enter your OrderID in the box
                                                                below and press "Track" button. This was given to you on
                                                                your receipt and in the confirmation email you should
                                                                have received.</p>
                                                            <div class="row">
                                                                <div class="col-lg-8">
                                                                    <form class="contact-form-style mt-30 mb-50"
                                                                        action="#" method="post">
                                                                        <div class="input-style mb-20">
                                                                            <label>Order ID</label>
                                                                            <input name="order-id"
                                                                                placeholder="Found in your order confirmation email"
                                                                                type="text" class="square">
                                                                        </div>
                                                                        <div class="input-style mb-20">
                                                                            <label>Billing email</label>
                                                                            <input name="billing-email"
                                                                                placeholder="Email you used during checkout"
                                                                                type="email" class="square">
                                                                        </div>
                                                                        <button class="submit submit-auto-width"
                                                                            type="submit">Track</button>
                                                                    </form>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>




                                                <div class="tab-pane fade" id="address" role="tabpanel"
                                                    aria-labelledby="address-tab">
                                                    <div class="row">
                                                        <% if(typeof userDetails?.Address !=="undefined" ) {%>

                                                            <% for(let i=0; i<userDetails?.Address.length; i++) {%>
                                                                <div class="col-lg-6">
                                                                    <div class="card mb-0 mb-lg-0 containerheader">
                                                                        <div class="card-header">
                                                                            <div
                                                                                class="d-flex justify-content-between align-items-center">
                                                                                <h5 class="mb-0">Address</h5>
                                                                                <div
                                                                                    class="form-check form-check-round">
                                                                                    <input class="form-check-input"
                                                                                        type="radio"
                                                                                        id="addressRadio<%= i %>"
                                                                                        name="selectedAddress"
                                                                                        value="<%= i %>"
                                                                                        <%=userDetails?.Address[i].status==true
                                                                                        ? 'checked' : '' %>
                                                                                    onclick="updateAddressStatus(<%= i
                                                                                        %>)">
                                                                                        <div class="product-delete-button position-absolute bottom-0 start-50 translate-middle-50 mb-1  col-lg-12"
                                                                                            id="deleteContainer<%= i %>">
                                                                                            <button
                                                                                                class="btn btn-primary delete-btn d-none "
                                                                                                style="font-size: 12px; line-height: 1; max-width: 100% "
                                                                                                onclick="deleteAddress()"
                                                                                                data-index="<%= userDetails?.Address[i]?._id %>">
                                                                                                <i class="fas fa-trash text-sm "
                                                                                                    style="font-size: 8px;"></i>
                                                                                                delete
                                                                                            </button>
                                                                                        </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="card-body">
                                                                            <address>
                                                                                <%= userDetails?.Address[i]?.housename
                                                                                    %><br>
                                                                                    <%= userDetails?.Address[i]?.Street
                                                                                        %><br>
                                                                                        <%= userDetails?.Address[i]?.City
                                                                                            %><br>
                                                                                            <%= userDetails?.Address[i]?.State
                                                                                                %>
                                                                            </address>
                                                                            <p>India</p>
                                                                            <a class="btn-small editButton"
                                                                                onclick="editAddress('<%= userDetails?.Address[i]?.housename %>', '<%= userDetails?.Address[i]?.Street %>', '<%= userDetails?.Address[i]?.City %>', '<%= userDetails?.Address[i]?.State %>', '<%= userDetails?.Address[i]?._id %>')" data-address="<%= i%>">Edit</a>
                                                                        </div>
                                                                    </div>
                                                                </div>


                                                                <script defer>
                                                                    async function editAddress(houseName, streetName, city, state, id) {
                                                                        const AddressId = id;
                                                                        console.log(AddressId);
                                                                
                                                                        const result = await Swal.fire({
                                                                            title: "Enter Address",
                                                                            html:
                                                                                '<input id="houseName" class="swal2-input" placeholder="House Name" value="' + houseName + '">' +
                                                                                '<input id="streetName" class="swal2-input" placeholder="Street Name" value="' + streetName + '">' +
                                                                                '<input id="city" class="swal2-input" placeholder="City" value="' + city + '">' +
                                                                                '<input id="state" class="swal2-input" placeholder="State" value="' + state + '">',
                                                                            showCancelButton: true,
                                                                            confirmButtonText: 'Submit',
                                                                            cancelButtonText: 'Cancel',
                                                                        });
                                                                
                                                                        if (result.isConfirmed) {
                                                                            var houseNameInput = document.getElementById("houseName").value
                                                                            var streetNameInput = document.getElementById('streetName').value
                                                                            var cityInput = document.getElementById('city').value
                                                                            var stateInput = document.getElementById('state').value
                                                                
                                                                            
                                                                            if (!houseNameInput.trim() || !streetNameInput.trim() || !cityInput.trim() || !stateInput.trim()) {
                                                                                
                                                                                Swal.fire({
                                                                                    icon: "Error",
                                                                                    title: "Validation Error",
                                                                                    text: "Please fill in all fields",
                                                                                    icon: "error",
                                                                                    confirmButtonText: "OK",
                                                                                });
                                                                                return;
                                                                            }
                                                                
                                                                            const AddressData = {
                                                                                houseName: houseNameInput,
                                                                                streetName: streetNameInput,
                                                                                cityName: cityInput,
                                                                                state: stateInput,
                                                                                id: AddressId
                                                                            };
                                                                
                                                                            console.log(AddressData);
                                                                
                                                                            try {
                                                                                const response = await fetch(`/editAddressfields?AddressData=${JSON.stringify(AddressData)}`, {
                                                                                    method: "GET",
                                                                                });
                                                                
                                                                                if (!response.ok) {
                                                                                    throw new Error("Internal server Error");
                                                                                }
                                                                
                                                                                const data = await response.json();
                                                                                console.log(data);
                                                                                window.location.reload()
                                                                            } catch (error) {
                                                                                console.log(error.message);
                                                                            }
                                                                        }
                                                                    }
                                                                </script>
                                                                
                                                                <% } %>
                                                                    <% } %>



                                                                        <script>

                                                                            const cardHeaders = document.querySelectorAll('.containerheader');


                                                                            cardHeaders.forEach(header => {

                                                                                header.addEventListener('mouseenter', () => {
                                                                                    const deleteButton = header.querySelector('.delete-btn');
                                                                                    deleteButton.classList.remove('d-none');
                                                                                });


                                                                                header.addEventListener('mouseleave', () => {
                                                                                    const deleteButton = header.querySelector('.delete-btn');
                                                                                    deleteButton.classList.add('d-none');
                                                                                });
                                                                            });
                                                                        </script>
                                                                        <script>

                                                                            const deleteButton = document.querySelectorAll(".delete-btn");
                                                                            deleteButton.forEach(button => {
                                                                                button.addEventListener("click", function () {
                                                                                    const index = (this.getAttribute("data-index"))
                                                                                    deleteAddress(index);
                                                                                })
                                                                            })




                                                                            async function deleteAddress(index) {




                                                                                try {
                                                                                    console.log(index);
                                                                                    const response = await fetch(`/deleteAddress?index1=${index}`, {
                                                                                        method: "GET",
                                                                                    })
                                                                                    if (!response) {
                                                                                        throw new Error("internal server error")
                                                                                    }
                                                                                    const data = await response.json()
                                                                                    console.log(data);
                                                                                    window.location.reload()



                                                                                } catch (error) {

                                                                                    console.log(error.message)

                                                                                }
                                                                            }
                                                                        </script>






                                                                        <script>
                                                                            async function updateAddressStatus(index) {
                                                                                console.log(index);

                                                                                try {
                                                                                    const response = await fetch(`/updateAddressStatus?index=${index}`, {
                                                                                        method: "GET"
                                                                                    });

                                                                                    if (!response.ok) {
                                                                                        throw new Error("Internal server error");
                                                                                    }

                                                                                    const data = await response.json();
                                                                                    console.log(data);
                                                                                    window.location.reload()
                                                                                } catch (error) {
                                                                                    console.error(error.message); // Log any errors that occur during the fetch request
                                                                                }
                                                                            }
                                                                        </script>



                                                                        <div class="col-lg-6">
                                                                            <div class="card">
                                                                                <div class="card-header">
                                                                                    <h5 class="mb-0">Add Address</h5>
                                                                                </div>
                                                                                <div class="card-body">
                                                                                    <!-- <address><br>
                                                                                  Sarasota, <br>FL 34249 USA <br>Phone: 1.941.227.4444</address> -->
                                                                                    <!-- <p>Sarasota</p> -->
                                                                                    <div
                                                                                        class="align-items-center text-center ">
                                                                                        <span
                                                                                            class="fa fa-plus-circle f5 text-center p-4 mb-2"
                                                                                            style="cursor: pointer; font-size: 100px;"
                                                                                            onclick="addAddress()"></span>
                                                                                    </div>


                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                    </div>
                                                </div>
                                            <script>
                                                async function addAddress() {
                                                    const result = await Swal.fire({
                                                        title: "Enter Address",
                                                        html: `
                                                            <input id="houseName" class="swal2-input" placeholder="House Name" onkeyup="validateInput(this)">
                                                            <p id="houseNameError"></p>
                                                            <input id="streetName" class="swal2-input" placeholder="Street Name" onkeyup="validateInput(this)">
                                                            <p id="streetError"></p>
                                                            <input id="city" class="swal2-input" placeholder="City" onkeyup="validateInput(this)">
                                                            <p id="cityError"></p>
                                                            <input id="state" class="swal2-input" placeholder="State" onkeyup="validateInput(this)">
                                                            <p id="stateError"></p>
                                                        `,
                                                        showCancelButton: true,
                                                        confirmButtonText: 'Submit',
                                                        cancelButtonText: 'Cancel',
                                                        preConfirm: () => {
                                                            const houseNameInput = document.getElementById("houseName");
                                                            const streetNameInput = document.getElementById("streetName");
                                                            const cityInput = document.getElementById("city");
                                                            const stateInput = document.getElementById("state");
                                                
                                                            const houseNameError = document.getElementById("houseNameError");
                                                            const streetError = document.getElementById("streetError");
                                                            const cityError = document.getElementById("cityError");
                                                            const stateError = document.getElementById("stateError");
                                                
                                                            const houseName = houseNameInput.value.trim();
                                                            const streetName = streetNameInput.value.trim();
                                                            const city = cityInput.value.trim();
                                                            const state = stateInput.value.trim();
                                                
                                                            let isValid = true;
                                                
                                                            if (houseName.length < 3) {
                                                                houseNameError.textContent = "House name is required and must be at least 3 characters long";
                                                                houseNameError.style.color = "red";
                                                                isValid = false;
                                                            } else {
                                                                houseNameError.textContent = "";
                                                            }
                                                
                                                            if (streetName.length < 3) {
                                                                streetError.textContent = "Street name is required and must be at least 3 characters long";
                                                                streetError.style.color = "red";
                                                                isValid = false;
                                                            } else {
                                                                streetError.textContent = "";
                                                            }
                                                
                                                            if (city.length < 3) {
                                                                cityError.textContent = "City is required and must be at least 3 characters long";
                                                                cityError.style.color = "red";
                                                                isValid = false;
                                                            } else {
                                                                cityError.textContent = "";
                                                            }
                                                
                                                            if (state.length < 2) {
                                                                stateError.textContent = "State is required and must be at least 2 characters long";
                                                                stateError.style.color = "red";
                                                                isValid = false;
                                                            } else {
                                                                stateError.textContent = "";
                                                            }
                                                
                                                            if (!isValid) {
                                                                return false;
                                                            }
                                                
                                                            return { houseName, streetName, city, state };
                                                        }
                                                    });
                                                
                                                    if (result.isConfirmed) {
                                                        const address = result.value;
                                                
                                                        try {
                                                            const response = await fetch(`/addAddress`, {
                                                                method: "POST",
                                                                headers: {
                                                                    "Content-Type": "application/json"
                                                                },
                                                                body: JSON.stringify({ address })
                                                            });
                                                
                                                            if (!response.ok) {
                                                                throw new Error("Internal Server Error");
                                                            }
                                                
                                                            const data = await response.json();
                                                            console.log(data);
                                                            if(data){
                                                                window.location.reload()
                                                            }
                                                        } catch (error) {
                                                            console.error(error);
                                                        }
                                                    }
                                                }
                                                
                                                function validateInput(input) {
                                                    const regex = /^[a-zA-Z0-9]*$/;
                                                    if (!regex.test(input.value)) {
                                                        input.value = input.value.replace(/[^a-zA-Z0-9]/g, '');
                                                    }
                                                }


                                                </script>



                                              <div class="tab-pane fade" id="account-detail" role="tabpanel"
                                                    aria-labelledby="account-detail-tab">
                                                    <div class="card">
                                                        <div class="card-header">
                                                            <h5>Account Details</h5>
                                                        </div>
                                                        <div class="card-body">
                                                            <p>Already have an account? <a
                                                                    href="page-login-register.html">Log in instead!</a>
                                                            </p>
                                                            <form method="post" name="enq" action="/newpasswordchange"
                                                                onsubmit="return validateForm()">
                                                                <div class="row">
                                                                    <div class="form-group col-md-6">
                                                                        <label>YOUR NAME<span
                                                                                class="required">*</span></label>
                                                                        <input id="name" class="form-control square"
                                                                            name="name" type="text" onkeyup="validateusername()"
                                                                            value="<%=userDetails?.name%>">
                                                                    </div>

                                                                    <div class="form-group col-md-6">
                                                                        <label>Email Address <span
                                                                                class="required"></span></label>
                                                                        <input disabled class="form-control square"
                                                                            name="email" type="email"
                                                                            value="<%= userDetails?.email %>">
                                                                    </div>

                                                                    <div class="form-group col-md-6">
                                                            <label>Current Password <span ></span></label>
                                                            <div class="input-group">
                                                                <input required="" class="form-control square" name="password" type="password" id="currentPassword">
                                                                <div class="input-group-append">
                                                                    <button type="button" class="btn btn-success" id="btnChangePassword" disabled>Change password</button>
                                                                </div>
                                                            </div>
                                                        </div>

                                                                    <div class="form-group col-md-6">
                                                                        <label>Save Changes<span
                                                                                class=""></span></label>
                                                                        <div class="input-group"> <button type="button"class="btn btn-success" id="btnSaveName" onclick="SaveName()">Save Name</button>

                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <script>
                                                                function validateusername(){
                                                                const nameInput = document.getElementById("name");

                                                                
                                                                    const name = nameInput.value.trim();

                                                                    if (!/^[a-zA-Z\s'-]+$/.test(name) || /[\d!@#$%^&*()_+=\[{\]};:<>|./?,-]/.test(name)) {
                                                                        const Toast = Swal.mixin({
                                                                            toast: true,
                                                                            position: "top-end",
                                                                            showConfirmButton: false,
                                                                            timer: 3000,
                                                                            timerProgressBar: true,
                                                                            didOpen: (toast) => {
                                                                                toast.addEventListener("mouseenter", Swal.stopTimer);
                                                                                toast.addEventListener("mouseleave", Swal.resumeTimer);
                                                                            }
                                                                        });
                                                                        Toast.fire({
                                                                            icon: "error",
                                                                            title: "Invalid Name"
                                                                        });
                                                                        return false;

                                                                        if(name.length<=3){
                                                                            return false;
                                                                        }else{
                                                                            return true;
                                                                        }
                                                                    }else{
                                                                        return true;
                                                                    }

                                                                  
                                                                }
                                                                    </script> 
                                  
                                                                <script> 
                                                                    async function SaveName() {

                                                                        var isValid = true;
                                                                        isValid &= validateusername();

                                                                        if(!isValid){
                                                                            swal.fire({
                                                                                icon:warning,
                                                                                title:"validation Error",

                                                                            })

                                                                        }else{ 
                                                                        const inputname = document.getElementById("name")
                                                                        const name =inputname.value
                                                                        if(name.length<3){
                                                                            Swal.fire({
                                                                                icon: "info",
                                                                                title:"minimum 3 charectors required"
                                                                            })
                                                                            inputname.style.border = "2px solid red";
                                    
                                                                            event.preventDefault()
                                                                        }

                                                                       
                                                                        console.log(name);
                                                                        const response = await fetch(`/updateName?name=${name}`, {
                                                                            method: "GET",
                                                                        })
                                                                        if (!response) {
                                                                            throw new Error("internal Server Error")
                                                                        }
                                                                        const data = await response.json()
                                                                        console.log(data);
                                                                        window.location.reload()

                                                                        name.textcontent = data;
                                                                        Swal.fire({
                                                                            title: "Username Saved"
                                                                        })
                                                                


                                                                    }
                                                                }
                                                                </script>

                                                                <div class="passwordFields d-none" id="passwordFields">
                                                                    <div class="">

                                                                        <div class="form-group col-md-12">
                                                                            <label>New Password <span></span></label>
                                                                            <input required="" class="" name="npassword"
                                                                                type="password" id="npassword">
                                                                        </div>
                                                                        <div class="form-group col-md-12">
                                                                            <label>Confirm Password
                                                                                <span>*</span></label>
                                                                            <input required=""
                                                                                class="form-control square"
                                                                                name="cpassword" type="password"
                                                                                id="cpassword">
                                                                        </div>
                                                                        <div class="col-md-12">
                                                                            <button type="submit"
                                                                                class="btn btn-fill-out submit"
                                                                                name="submit"
                                                                                value="Submit">Save</button>
                                                                        </div>
                                                                    </div>
                                                                </div>


                                                                <script defer>
                                                                    let timeoutId;

                                                                    const currentPassword = document.getElementById("currentPassword").addEventListener("input", function () {



                                                                        clearTimeout(timeoutId)

                                                                        timeoutId = setTimeout(() => sendRequest(), 2000)



                                                                    })



                                                                    async function sendRequest() {
                                                                        const currentPassword = document.getElementById("currentPassword").value;
                                                                        console.log(currentPassword)
                                                                        const currentPasswordfield = document.getElementById("currentPassword")


                                                                        const response = await fetch("/currentPassword", {
                                                                            method: "post",
                                                                            headers: {
                                                                                "content-Type": "application/json"
                                                                            },
                                                                            body: JSON.stringify({ password: currentPassword })
                                                                        })
                                                                        if (!response) {
                                                                            throw new Error("internl server error")

                                                                        }
                                                                        const data = await response.json();
                                                                        console.log(data)
                                                                        if (data.data == false) {
                                                                            console.log("false")
                                                                            currentPasswordfield.style.border = "2px solid red";
                                                                            currentPasswordfield.style.borderBottomColor = "red !important"


                                                                        } else if (data.data == true) {
                                                                            console.log("green")

                                                                            currentPasswordfield.style.border = "2px solid green";
                                                                            currentPasswordfield.style.borderBottomColor = "green !important"
                                                                            const changePasswordbtn =document.getElementById("btnChangePassword")
                                                                            changePasswordbtn.disabled=false;
                                                                            changePasswordbtn.addEventListener("click", function(){
                                                                                document.getElementById("passwordFields").classList.remove("d-none");
                                                                            })

                                                                            


                                                                        }
                                                                    }

                                                                    // async function displayfields() {
                                                                    //     const elements = document.getElementsByClassName("d-none");
                                                                    //     Array.from(elements).forEach(element => {
                                                                    //         element.classList.remove("d-none");
                                                                    //     });



                                                                    // }
                                                                    function validateForm() {
                                                                        const newpassword = document.getElementById("npassword").value
                                                                        const currentPassword = document.getElementById("cpassword").value


                                                                        if (newpassword.length < 6) {
                                                                            Swal.fire({
                                                                                icon: "warning",
                                                                                title: "Atleast 6 digit password required"

                                                                            })

                                                                            return false
                                                                        } if (newpassword !== currentPassword) {
                                                                            Swal.fire({
                                                                                icon: "warning",
                                                                                title: "password is not matching"

                                                                            })
                                                                            return false


                                                                        }
                                                                        return true

                                                                    }          
                                                                </script>
                                                                    <!-- <li class="nav-item">
                                                                        <a class="nav-link" id="Wallet-tab" data-bs-toggle="tab"
                                                                            href="#wallet" role="tab" aria-controls="Wallet"
                                                                            aria-selected="false"><i
                                                                                class="fi-rs-shopping-bag mr-10"></i>Wallet</a>
                                                                    </li> -->
                                                        </div>
                                                        </form>
                                                    </div>
                                                </div>

                                                <div class="tab-pane fade" id="Wallet-tab" role="tabpanel" aria-labelledby="Wallet-tab-link">
                                                    <div class="card bg-light border">  <div class="card-body d-flex justify-content-between">  
                                                        <p class="card-text mt-3">Wallet Balance:  &#8377; <%= WalletDetail?.TotalAmount %> <span id="wallet-balance"></span></p> 
                                                        <div class="d-flex">  
                                                      <input type="number" class="form-control" id="walletinput" placeholder="Enter Amount"> 
                                                        <button type="button" class="btn btn-primary small" id="walletButton">Add Funds</button> 
                                                    </div>
                                                                                </div>
                                                                                </div>
                                                                                <style>
                                                                                    .custom-radio .custom-control-label::before,
                                                                                    .custom-radio .custom-control-input:checked~.custom-control-label::before {
                                                                                        width: 1.25rem;
                                                                                        height: 1.25rem;
                                                                                    }
                                                                                </style>
                                                                                <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

                                                                                <script>
                                                                                    document.addEventListener("DOMContentLoaded", function() {
                                                                                        var wallet = document.getElementById("walletinput");
                                                                                        const walletButton = document.getElementById("walletButton");
                                                                                
                                                                                        wallet.addEventListener("input", function() {
                                                                                            if (parseFloat(wallet.value) <= 0) {
                                                                                                wallet.style.borderColor = "red";
                                                                                            } else {
                                                                                                wallet.style.borderColor = ""; 
                                                                                                walletButton.disabled = false;
                                                                                            }
                                                                                        });
                                                                                
                                                                                        walletButton.addEventListener("click", function(){
                                                                                            if (wallet.value <= 0) {
                                                                                                Swal.fire({
                                                                                                    icon: "error",
                                                                                                    title: "Invalid Entry"
                                                                                                });
                                                                                            } else {
                                                                                                Swal.fire({
                                                                                                    title: 'Select Payment Method',
                                                                                                    html: `
                                                                                                        <div class="form-check form-check-inline custom-radio">
                                                                                                            <input class="form-check-input" type="radio" id="radioOption1" name="radioOptions" value="Razorpay" checked >
                                                                                                            <label class="form-check-label" for="radioOption1">Razor Pay</label>
                                                                                                        </div>
                                                                                                        <div class="form-check form-check-inline custom-radio">
                                                                                                            <input class="form-check-input" type="radio" id="radioOption2" name="radioOptions" value="paypal">
                                                                                                            <label class="form-check-label" for="radioOption2">PAY PAL</label>
                                                                                                        </div>
                                                                                                    `,
                                                                                                    showCancelButton: true,
                                                                                                    confirmButtonText: 'Submit',
                                                                                                    showLoaderOnConfirm: true,
                                                                                                    preConfirm: async () => {
                                                                                                        const selectedOption = document.querySelector('input[name="radioOptions"]:checked');
                                                                                                        if (selectedOption.value == "Razorpay") {
                                                                                                            const responseStatus = await fetch(`/addtoWallet?walletAmount=${wallet.value}`,{
                                                                                                                method:"GET"
                                                                                                            });
                                                                                                            if (!responseStatus.ok) {
                                                                                                                throw new Error("Internal Server Error");
                                                                                                            }
                                                                                                            const data = await responseStatus.json();
                                                                                                            console.log(data.order);
                                                                                                            var options = {
                                                                                                                "key": "rzp_test_ihsNz6lracNIu3", 
                                                                                                                "amount": data.order.amount, 
                                                                                                                "currency": "INR",
                                                                                                                "name": "Karnan Corp",
                                                                                                                "description": "Test Transaction",
                                                                                                                "image": "https://example.com/your_logo",
                                                                                                                "order_id": data.order.order_id, 
                                                                                                                "handler": async (responseHandler) => {
                                                                                                                    const responseStatus = await fetch(`/addAmounttoWallet?amount=${data.order.amount}`,{
                                                                                                                        method:"GET"

                                                                                                                    })
                                                                                                                    if(!responseStatus){
                                                                                                                        throw new Error("Internal Server Error")
                                                                                                                    }
                                                                                                                    const datas= responseStatus.json()
                                                                                                                    console.log(datas.datas)
                                                                                                                    const Toast = Swal.mixin({
                                                                                                                    toast: true,
                                                                                                                    position: "top-end",
                                                                                                                    showConfirmButton: false,
                                                                                                                    timer: 3000,
                                                                                                                    timerProgressBar: true,
                                                                                                                    didOpen: (toast) => {
                                                                                                                        toast.onmouseenter = Swal.stopTimer;
                                                                                                                        toast.onmouseleave = Swal.resumeTimer;
                                                                                                                    }
                                                                                                                    });
                                                                                                                    Toast.fire({
                                                                                                                    icon: "success",
                                                                                                                    title: "Amont credited to The Wallet"
                                                                                                                    }).then(()=>window.location.reload())
                                                                                                                    
                                                                                                                   
                                                                                                                },
                                                                                                                "theme": {
                                                                                                                    "color": "#3399cc"
                                                                                                                }
                                                                                                            };
                                                                                                            var rzp1 = new Razorpay(options);
                                                                                                            rzp1.on('payment.failed', async (responseFailed) => {
                                                                                                                const Toast = Swal.mixin({
                                                                                                                    toast: true,
                                                                                                                    position: "top-end",
                                                                                                                    showConfirmButton: false,
                                                                                                                    timer: 3000,
                                                                                                                    timerProgressBar: true,
                                                                                                                    didOpen: (toast) => {
                                                                                                                        toast.onmouseenter = Swal.stopTimer;
                                                                                                                        toast.onmouseleave = Swal.resumeTimer;
                                                                                                                    }
                                                                                                                    });
                                                                                                                    Toast.fire({
                                                                                                                    icon: "warning",
                                                                                                                    title: "Transaction Failed"
                                                                                                                    }).then(()=>window.location.reload())
                                                                                                                
                                                                                                            });
                                                                                                            rzp1.open();
                                                                                                        }   
                                                                                                        return true;
                                                                                                    }
                                                                                                });
                                                                                            }
                                                                                        });
                                                                                    });
                                                                                </script>
                                                                                
                                                                                

                                                <section class="content-main">
                                                    <div class="content-header">
                                                        <h2 class="content-title">Transactions </h2>
                                                    </div>
              
                                                    <div class="card">
                                                        <div class="card-body">
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <header class="border-bottom mb-4 pb-4">
                                                                        <div class="row">
                                                                            

                                                                        </div>
                                                                    </header> <!-- card-header end// -->
                                                                    <div class="table-responsive">
                                                                        <table class="table table-hover">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>Transaction ID</th>
                                                                                    <th>Paid</th>
                                                                                    <th>TransactionType</th>
                                                                                    <th>Date</th>
                                                                                    <th class="text-end"> Description </th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                <%if(WalletDetail) {%>
                                                                                <%const reversedWallet = WalletDetail.history.reverse()%>
                                                                                <% reversedWallet.forEach((item)=> {%> 
                                                            
                                                                                    
                                                                                <tr>
                                                                                    <td><b><%=item.transactionId%></b></td>
                                                                                    <td><%=item.amount%></td>
                                                                                    <td>
                                                                                        <div class="icontext">
                                                                                            <!-- <img class="icon border" src="assets/imgs/card-brands/1.png" alt="Payment"> -->
                                                                                            <span class="text text-muted <%= item.type == "Credit"? "alertSuccess" : "alertWarning"%>"><%=item.type%></span>
                                                                                        </div>
                                                                                    </td>
                                                                                    <td><%= item.createdAt.toLocaleDateString() %> &nbsp;</td>

                                                                                    <td class="text-end">
                                                                                        <a href="#" class=" font-sm rounded"> <%=item.description%></a>
                                                                                    </td>
                                                                                </tr>

                                                                                <%})%>
                                                                                <%}%>
                                                                            </tbody>
                                                                        </table>
                                                                    </div> <!-- table-responsive.// -->
                                                                </div> <!-- col end// -->
                                                             
                                                            </div> <!-- row end// -->
                                                        </div> <!-- card-body // -->
                                                    </div> <!-- card end// -->
                                                    <div class="pagination-area mt-30 mb-50">
                                                        <nav aria-label="Page navigation example">
                                                            <ul class="pagination justify-content-start">
                                                                <li class="page-item active"><a class="page-link" href="#">01</a></li>
                                                                <li class="page-item"><a class="page-link" href="#">02</a></li>
                                                                <li class="page-item"><a class="page-link" href="#">03</a></li>
                                                                <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                                                                <li class="page-item"><a class="page-link" href="#">16</a></li>
                                                                <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                                                            </ul>
                                                        </nav>
                                                    </div>
                                                </section>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </div>
                    </section>

                </main>
                <footer class="main">
                    <section class="newsletter p-30 text-white wow fadeIn animated">
                        <div class="container">
                            <div class="row align-items-center">
                                <div class="col-lg-7 mb-md-3 mb-lg-0">
                                    <div class="row align-items-center">
                                        <div class="col flex-horizontal-center">
                                            <img class="icon-email" src="/assets/imgs/theme/icons/icon-email.svg"
                                                alt="">
                                            <h4 class="font-size-20 mb-0 ml-3">Sign up to Newsletter</h4>
                                        </div>
                                        <div class="col my-4 my-md-0 des">
                                            <h5 class="font-size-15 ml-4 mb-0">...and receive <strong>$25 coupon for
                                                    first shopping.</strong></h5>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-5">
                                    <!-- Subscribe Form -->
                                    <form class="form-subcriber d-flex wow fadeIn animated">
                                        <input type="email" class="form-control bg-white font-small"
                                            placeholder="Enter your email">
                                        <button class="btn bg-dark text-white" type="submit">Subscribe</button>
                                    </form>
                                    <!-- End Subscribe Form -->
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="section-padding footer-mid">
                        <div class="container pt-15 pb-20">
                            <div class="row">
                                <div class="col-lg-4 col-md-6">
                                    <div class="widget-about font-md mb-md-5 mb-lg-0">
                                        <div class="logo logo-width-1 wow fadeIn animated">
                                            <a href="index.html"><img
                                                    src="https://www.thesouledstore.com/static/img/newlogo.8dcc6cc.png"
                                                    alt="logo"></a>
                                        </div>
                                        <h5 class="mt-20 mb-10 fw-600 text-grey-4 wow fadeIn animated">Contact</h5>
                                        <p class="wow fadeIn animated">
                                            <strong>Address: </strong>562 Wellington Road, Street 32, San Francisco
                                        </p>
                                        <p class="wow fadeIn animated">
                                            <strong>Phone: </strong>+01 2222 365 /(+91) 01 2345 6789
                                        </p>
                                        <p class="wow fadeIn animated">
                                            <strong>Hours: </strong>10:00 - 18:00, Mon - Sat
                                        </p>
                                        <h5 class="mb-10 mt-30 fw-600 text-grey-4 wow fadeIn animated">Follow Us</h5>
                                        <div class="mobile-social-icon wow fadeIn animated mb-sm-5 mb-md-0">
                                            <a href="#"><img src="/assets/imgs/theme/icons/icon-facebook.svg"
                                                    alt=""></a>
                                            <a href="#"><img src="/assets/imgs/theme/icons/icon-twitter.svg" alt=""></a>
                                            <a href="#"><img src="/assets/imgs/theme/icons/icon-instagram.svg"
                                                    alt=""></a>
                                            <a href="#"><img src="/assets/imgs/theme/icons/icon-pinterest.svg"
                                                    alt=""></a>
                                            <a href="#"><img src="/assets/imgs/theme/icons/icon-youtube.svg" alt=""></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-2 col-md-3">
                                    <h5 class="widget-title wow fadeIn animated">About</h5>
                                    <ul class="footer-list wow fadeIn animated mb-sm-5 mb-md-0">
                                        <li><a href="#">About Us</a></li>
                                        <li><a href="#">Delivery Information</a></li>
                                        <li><a href="#">Privacy Policy</a></li>
                                        <li><a href="#">Terms &amp; Conditions</a></li>
                                        <li><a href="#">Contact Us</a></li>
                                        <li><a href="#">Support Center</a></li>
                                    </ul>
                                </div>
                                <div class="col-lg-2  col-md-3">
                                    <h5 class="widget-title wow fadeIn animated">My Account</h5>
                                    <ul class="footer-list wow fadeIn animated">
                                        <li><a href="#">Sign In</a></li>
                                        <li><a href="#">View Cart</a></li>
                                        <li><a href="#">My Wishlist</a></li>
                                        <li><a href="#">Track My Order</a></li>
                                        <li><a href="#">Help</a></li>
                                        <li><a href="#">Order</a></li>
                                    </ul>
                                </div>
                                <div class="col-lg-4">
                                    <h5 class="widget-title wow fadeIn animated">Install App</h5>
                                    <div class="row">
                                        <div class="col-md-8 col-lg-12">
                                            <p class="wow fadeIn animated">From App Store or Google Play</p>
                                            <div class="download-app wow fadeIn animated">
                                                <a href="#" class="hover-up mb-sm-4 mb-lg-0"><img class="active"
                                                        src="/assets/imgs/theme/app-store.jpg" alt=""></a>
                                                <a href="#" class="hover-up"><img
                                                        src="/assets/imgs/theme/google-play.jpg" alt=""></a>
                                            </div>
                                        </div>
                                        <div class="col-md-4 col-lg-12 mt-md-3 mt-lg-0">
                                            <p class="mb-20 wow fadeIn animated">Secured Payment Gateways</p>
                                            <img class="wow fadeIn animated" src="/assets/imgs/theme/payment-method.png"
                                                alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <div class="container pb-20 wow fadeIn animated">
                        <div class="row">
                            <div class="col-12 mb-20">
                                <div class="footer-bottom"></div>
                            </div>
                            <div class="col-lg-6">
                                <p class="float-md-left font-sm text-muted mb-0">&copy; 2022, <strong
                                        class="text-brand">Evara</strong> - HTML Ecommerce Template </p>
                            </div>
                            <div class="col-lg-6">
                                <p class="text-lg-end text-start font-sm text-muted mb-0">
                                    Designed by <a href="http://alithemes.com/" target="_blank">Alithemes.com</a>. All
                                    rights reserved
                                </p>
                            </div>
                        </div>
                    </div>
                </footer>
                <!-- Preloader Start -->
                <div id="preloader-active">
                    <div class="preloader d-flex align-items-center justify-content-center">
                        <div class="preloader-inner position-relative">
                            <div class="text-center">
                                <h5 class="mb-5">Now Loading</h5>
                                <div class="loader">
                                    <div class="bar bar1"></div>
                                    <div class="bar bar2"></div>
                                    <div class="bar bar3"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Vendor JS-->
                <script src="/assets/js/vendor/modernizr-3.6.0.min.js"></script>
                <script src="/assets/js/vendor/jquery-3.6.0.min.js"></script>
                <script src="/assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
                <script src="/assets/js/vendor/bootstrap.bundle.min.js"></script>
                <script src="/assets/js/plugins/slick.js"></script>
                <script src="/assets/js/plugins/jquery.syotimer.min.js"></script>
                <script src="/assets/js/plugins/wow.js"></script>
                <script src="/assets/js/plugins/jquery-ui.js"></script>
                <script src="/assets/js/plugins/perfect-scrollbar.js"></script>
                <script src="/assets/js/plugins/magnific-popup.js"></script>
                <script src="/assets/js/plugins/select2.min.js"></script>
                <script src="/assets/js/plugins/waypoints.js"></script>
                <script src="/assets/js/plugins/counterup.js"></script>
                <script src="/assets/js/plugins/jquery.countdown.min.js"></script>
                <script src="/assets/js/plugins/images-loaded.js"></script>
                <script src="/assets/js/plugins/isotope.js"></script>
                <script src="/assets/js/plugins/scrollup.js"></script>
                <script src="/assets/js/plugins/jquery.vticker-min.js"></script>
                <script src="/assets/js/plugins/jquery.theia.sticky.js"></script>
                <!-- Template  JS -->
                <script src="/assets/js/maind134.js?v=3.4"></script>
</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/page-account.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Jul 2023 10:11:15 GMT -->

</html>